
<!doctype html>
<!--html manifest="cache.manifest"-->
<html>
  <head>
    <meta charset="UTF-8" />
    <title>coffeeMan</title>

    <meta name="apple-mobile-web-app-title" content="coffeeMan">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="/lib/jquery.mobile-1.4.5.min.css" />
    <script src="/lib/jquery-1.11.1.min.js"></script>
    <script src="/lib/jquery.mobile-1.4.5.min.js"></script>

    <style type="text/css">
        .full-width-slider input {display: none;}
        .full-width-slider .ui-slider-track {margin-left: 15px;}
    </style>

    <script>
        $(function() {
            function supportsLocalStorage() {
                  try {
                    return 'localStorage' in window && window['localStorage'] !== null;
                } catch (e) {
                    return false;
                  }
            }
            function saveCoffee() {
                if (!supportsLocalStorage()) { return false; }
                localStorage[$("#coffee_name").val()] = JSON.stringify({
                    'category': $('#category_list').val(),
                    'taste': $("#coffee_taste").val()
                });
                location.reload();
            }
            function getList() {
                if (!supportsLocalStorage()) { return false; }
                var coffees = localStorage.length;
                $('#list ul').html("");
                for (var i = 0; i < coffees; i++) {
                    try {
                        var coffee_name = localStorage.key(i);
                        var coffee = JSON.parse(localStorage[coffee_name]);
                        $('#list ul').append('<li><a href="#view" title="' + coffee_name +'">' + coffee_name + ' <span class="ui-li-count">' + coffee['category'] + '</span></a></li>');
                    } catch (e) { continue; }
                }

            }

            function getCoffee() {
                if (!supportsLocalStorage()) { return false; }
                var coffee_name = this.title;

                var coffee = JSON.parse(localStorage[coffee_name]);
                var view = '<li>' + coffee['category'] + '</li>';
                view += '<li>' + coffee['taste'] + '</li>';
                $('#view ul').html(view);
                $('#view h1').html(coffee_name);
            }

            getList();
            $('#list ul a').click(getCoffee);
            $('#add form').submit(saveCoffee);
            $('#add .whiteButton').click(saveCoffee);
        });
        $( document ).on( "mobileinit", function() {
            $.mobile.listview.prototype.options.autodividersSelector = function( elt ) {
                // TODO: GET Category
                var text = $.trim( elt.text() ) || null;
                if ( !text ) {
                    return null;
                }
                if ( !isNaN(parseFloat(text)) ) {
                    return "0-9";
                } else {
                    text = text.slice( 0, 1 ).toUpperCase();
                    return text;
                }
            };
        });
    </script>
  </head>

<body>
    <div data-role="page" id="start">
        <div data-role="header">
            <h1>coffeeMan | Login</h1>
        </div>
        <div role="main" class="ui-content">
            <form id="login" action="#" method="GET">
                <input type="email" name="email" placeholder="email@example.com" id="email" />
                <input type="password" name="password" value="qwerty" id="password" />
                <a href="#list" class="ui-shadow ui-btn ui-corner-all">Войти</a>
            </form>
        </div>
    </div>
    <div data-role="page" id="list">
        <div data-role="header">
            <h1>coffeeMan</h1>
            <a href="#start" class="ui-nodisc-icon ui-alt-icon ui-btn ui-corner-all ui-btn-icon-left ui-icon-power ui-btn-icon-notext">Logout</a>
            <!--a href="#logout" class="button"><i class="fa fa-sign-out fa-lg"></i></a-->
            <a href="#add" class="ui-nodisc-icon ui-alt-icon ui-btn ui-corner-all ui-btn-icon-right ui-icon-plus ui-btn-icon-notext">Add</a>
        </div>
        <div role="main" class="ui-content">
            <ul data-role="listview" data-filter="true" data-filter-placeholder="Фильтр" data-inset="false" class="ui-nodisc-icon ui-alt-icon" data-count-theme="b" data-autodividers="true">
                <li><a href="#haus" title="Хаус бленд">Хаус бленд <span class="ui-li-count">эспрессо</span></a></li>
                <li><a href="#hazzelnut">Лесной орех <span class="ui-li-count">десерт</span></a></li>
            </ul>
        </div>
    </div>
    <div data-role="page" id="add" class="ui-nodisc-icon ui-alt-icon">
        <div data-role="header" data-add-back-btn="true" data-back-btn-text="К списку">
            <h1>coffeeMan | Add</h1>
        </div>
        <div role="main" class="ui-content">
            <form action="#" method="GET">
                <input type="text" name="coffee_name" placeholder="Arabica" id="coffee_name" />
                <select id="category_list" data-mini="true">
                    <option value="десерт"/>Десертный</option>
                    <option value="эспрессо"/>Эспрессо</option>
                    <option value="классика"/>Классический</option>
                    <option value="микс"/>Микс</option>
                </select>
                <div class="full-width-slider">
                    <label for="sugar">Горький</label>
                    <input type="range" name="sugar" id="sugar" min="0" max="10" value="5" data-show-value="true">
                    <label for="fruit">Фруктовый</label>
                    <input type="range" name="fruit" id="fruit" min="0" max="10" value="5" data-show-value="true">
                    <label for="choco">Шоколадный</label>
                    <input type="range" name="choco" id="choco" min="0" max="10" value="5" data-show-value="true">
                </div>

                <a href="#list" id="add_coffee" class="ui-shadow ui-btn ui-corner-all">Добавить</a>
            </form>
        </div>
    </div>
    <div data-role="page" id="view" class="ui-nodisc-icon ui-alt-icon">
        <div data-role="header" data-add-back-btn="true" data-back-btn-text="К списку">
            <h1>coffeeMan</h1>
        </div>
        <div role="main" class="ui-content">
            <ul class="edgetoedge scroll">
            </ul>
        </div>
    </div>
</body>
</html>
